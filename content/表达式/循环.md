在 Rust 中，各种循环都是表达式。四种循环表达式：

```rust
while condition {
	block
}

while let pattern = expr {
	block
}

loop {
	block
}

for pattern in iterable {
	block
}
```

## loop

Rust 提供 `loop` 关键字来表示无限循环。跟其他编程语言一样，可以使用 `break` 退出循环，使用 `continue` 用于跳过其余的迭代并开始新的循环。

```rust
fn main() {
   let mut sum = 0;
   let mut n = 0; 

   loop {
        sum += n;
        n += 1;
        if n > 100 {
            break;
        }
   }

   println!("Sum of 1 to 100 is: {}", sum)
}
```

`break` 后可带上一个值：

```rust
fn main() {
    let mut sum = 0;
    let mut n = 0;

    let result = loop {
        sum += n;
        n += 1;
        if n > 100 {
            break sum;
        }
    };

    println!("Result of loop is: {}", result);
}
```

## while 表达式

`while` 是带循环条件的 `loop`。

```rust
fn main() {
    let mut n = 0;
    while n < 5 {
        println!("n is {}", n);
        n += 1;
    }
}
```

## for

`for` 循环会对可迭代表达式求值，然后为结果迭代器中的每个值运行一次循环体。

```rust
fn main() {
    for i in 0..10 {
        println!("Hello, world! {}", i);
    }
}
```

`..` 运算符会生成一个范围。 `0..10` 用于创建包含0但不包含10，步长为1的迭代器。如果想创建包含10的迭代器，可以将 `0..10` 改为 `0..=10`。

遍历数组的例子：

```rust
fn main() {
    let myarray = [1, 2, 3, 4, 5];
    for i in myarray.iter() {
        println!("Hello, world! {}", i);
    }
}
```

## 循环中的控制流

`continue` 表达式会转跳到循环的下一次迭代，这个与其他编程语言相同。

`break` 表达式会退出所在循环，但是在 Rust 中的用法与其它语言存在差异。在 Rust 中，`break` 只能用在循环中，不能用在 `match` 表达式中，这与其他语言的 `switch` 语句不同。

在 `loop` 循环体中，可以在 `break` 后面跟一个表达式，该表达式会成为 `loop` 的值：

```rust
fn main() {
   let mut sum = 0;
   let mut n = 0; 

   loop {
        sum += n;
        n += 1;
        if n > 100 {
            break;
        }
   }

   println!("Sum of 1 to 100 is: {}", sum)
}
```

如果有多个 `break` 表达式的话，需要确保必须生成具有相同类型的值。

### 声明周期标签

循环可以带有生命周期标签。`'search:` 是外部 `for` 循环的标签。因此，`break 'search` 会退出这层循环，而不是退出内部循环

```rust
'search:
for room in apartment {
    for spot in room.hiding_spots() {
        if spot.contains(keys) {
            println!("Your keys are {} in the {}.", spot, room);
            break 'search;
        }
    }
}
```

`break` 可以同时具有标签和值表达式：

```rust
// 找到此系列中第一个完全平方数的平方根
let sqrt = 'outer: loop {
    let n = next_number();
    for i in 1.. {
        let square = i * i;
        if square == n {
            // 找到了一个平方根
            break 'outer i;
        }
        if square > n {
            // `n`不是完全平方数，尝试下一个
            break;
        }
    }
};
```